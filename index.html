<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Language Docs</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #111;
      color: white;
    }

    pre code {
      display: block;
      padding: 1rem;
      background-color: #1e1e1e;
      color: #d4d4d4;
      font-family: Consolas, monospace;
      border-radius: 0.5rem;
      overflow-x: auto;
    }

    blockquote {
      background: #f9f9f9;
      border-left: 10px solid #ccc;
      margin: 1.5em 10px;
      padding: 0.5em 10px;
      quotes: "\201C""\201D""\2018""\2019";
    }

    blockquote:before {
      color: #ccc;
      content: open-quote;
      font-size: 4em;
      line-height: 0.1em;
      margin-right: 0.25em;
      vertical-align: -0.4em;
    }

    blockquote p {
      display: inline;
    }

    .callout {
      background-color: #2f2b29;
      border-left: 4px solid #2f2b29;
      color: #25333b;
      padding: 1rem;
      margin: 1.5rem 0;
    }

    .sidebar a.active {
      color: #3b82f6;
      font-weight: bold;
    }

    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      bottom: 0;
      width: 250px;
      background-color: #1f1f1f;
      padding: 20px;
      border-right: 2px solid #333;
      overflow-y: auto;
      z-index: 100;
    }

    .sidebar h2 {
      color: #fff;
      margin-bottom: 20px;
    }

    .sidebar a {
      display: block;
      color: #bbb;
      margin-top: 8px;
      font-size: 14px;
      text-decoration: none;
    }

    .sidebar a:hover {
      color: #fff;
    }

    .sidebar a.active {
      color: #3b82f6;
      font-weight: bold;
    }

    .doc-content {
      margin-left: 270px;
      padding: 20px;
      min-height: 100vh;
    }

    .doc-content h1,
    .doc-content h2,
    .doc-content h3 {
      margin-top: 20px;
      color: #fff;
    }

    .doc-content p {
      margin-bottom: 20px;
      color: #ddd;
    }

    .lua-header {
      background-color: #333;
      color: #fff;
      padding: 10px;
      font-size: 16px;
      margin-top: 20px;
      border-radius: 5px;
      margin-bottom: 10px;
    }

    .lua-block {
      background-color: #1e1e1e;
      padding: 15px;
      border-radius: 8px;
      margin-top: 10px;
      font-family: Consolas, monospace;
    }
  </style>
</head>

<body>
  <!-- Topbar -->
  <header class="bg-gray-800 px-6 py-4 shadow-md z-10">
    <h1 class="text-2xl font-bold text-white">My Language Docs</h1>
  </header>

  <div class="flex">
    <aside class="sidebar">
      <h2 class="text-lg font-semibold text-white">Navigation</h2>
      <nav id="sidebar-nav" class="space-y-1">
        <!-- Sidebar content will go here -->
      </nav>
    </aside>

    <main class="flex-1 doc-content" id="content">
      <!-- Document content will go here -->
    </main>
  </div>

  <script>
    const rawContent = `
# 1. Lorem
## 1.1 Ipsum
Lorem ipsum dolor sit amet.

<LUA>$Title: Lua Example$
local a = "Hello World"
print(a)
</LUA>

### 1.1.1 Sub-Ipsum
Another detail about Ipsum.

<LUA>$Title: Another Lua Example$
local x = 10
local y = 20
print(x + y)
</LUA>
`;

    function parseContent(raw) {
      const lines = raw.split('\n');
      const contentContainer = document.getElementById('content');
      const nav = document.getElementById('sidebar-nav');
      let html = '';
      let navHTML = '';
      let currentCategory = '';
      let subIndex = 0;
      let lastCatName = "start"

      lines.forEach(line => {
        if (line.startsWith('# ')) {
          currentCategory = line.replace('# ', '').trim();
          navHTML += `<div class='mt-4 text-sm font-bold text-white'>${currentCategory}</div>`;
          html += `<h1 id="header-${currentCategory}" class="text-xl font-semibold mt-8 mb-2 text-white">${currentCategory}</h1>`;
        } else if (line.startsWith('## ')) {
          const sub = line.replace('## ', '').trim();
          const id = `section-${++subIndex}`;
          navHTML += `<a href="#${id}" data-id="${id}" class="ml-4 text-sm text-gray-400 hover:text-white">${sub}</a>`;
          html += `<h2 id="${id}" class="text-xl font-semibold mt-8 mb-2 text-white">${sub}</h2>`;
          lastCatName = sub;
        } else if (line.startsWith('### ')) {
          const sub = line.replace('### ', '').trim();
          const id = `section-${lastCatName}-${++subIndex}`;
          navHTML += `<a href="#${id}" data-id="${id}" class="ml-6 text-sm text-gray-400 hover:text-white">${sub}</a>`;
          html += `<h3 id="${id}" class="text-xl font-semibold mt-8 mb-2 text-white">${sub}</h3>`;
        } else if (line.startsWith('<LUA>')) {
          const titleMatch = line.match(/\$Title: (.*?)\$/);
          const title = titleMatch ? titleMatch[1] : "Code Block";
          html += `<div class="lua-header">${title}</div><div class="lua-block"><pre><code>`;
        } else if (line.startsWith('</LUA>')) {
          html += '</code></pre></div>';
        } else {
          html += `<p class="mb-4 text-gray-300">${line}</p>`;
        }
      });

      contentContainer.innerHTML = html;
      nav.innerHTML = navHTML;

      const links = nav.querySelectorAll('a');
      function updateActive() {
        let activeFound = false;
        links.forEach(link => {
          const section = document.getElementById(link.dataset.id);
          if (!section) return;
          const rect = section.getBoundingClientRect();
          if (!activeFound && rect.top >= 0 && rect.top < window.innerHeight / 2) {
            links.forEach(l => l.classList.remove('active'));
            link.classList.add('active');
            activeFound = true;
          }
        });
      }

      window.addEventListener('scroll', updateActive);
      updateActive();
    }

    parseContent(rawContent);
  </script>
</body>

</html>
