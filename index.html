<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Language Docs</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <style>
    pre code {
      display: block;
      padding: 1rem;
      background-color: #1e1e1e;
      color: #d4d4d4;
      font-family: Consolas, monospace;
      border-radius: 0.5rem;
      overflow-x: auto;
    }

    .callout {
      @apply bg-blue-100 border-l-4 border-blue-500 text-blue-900 p-4 my-6;
    }

    .doc-content h3 {
      @apply text-xl font-semibold mt-6 mb-2;
    }

    .sidebar a {
      @apply block text-gray-700 hover:text-blue-600 py-1;
    }
  </style>
</head>

<body class="flex min-h-screen bg-gray-50">
  <aside class="w-64 bg-white shadow-md p-4 sidebar">
    <h2 class="text-lg font-bold mb-4">Documentation</h2>
    <nav id="sidebar-nav">
      <!-- Sidebar items will be dynamically populated -->
    </nav>
  </aside>

  <main class="flex-1 p-8 doc-content" id="content">
    <!-- Content will be inserted here -->
  </main>

  <script>
    const rawContent = `
> 1Category
>> 1.1  Sub-category
# Header
Brief content text
<LUA>
local a = "b"
</LUA>
<image src='/assets/luaPageTest.png' alt='aaaaaaa' />
`;

    function parseContent(raw) {
      const lines = raw.split('\n');
      const contentContainer = document.getElementById('content');
      const nav = document.getElementById('sidebar-nav');
      let html = '';
      let navHTML = '';
      let currentCategory = '';
      let subIndex = 0;

      lines.forEach(line => {
        if (line.startsWith('> ')) {
          currentCategory = line.replace('> ', '').trim();
          navHTML += `<div class='mt-2 font-semibold'>${currentCategory}</div>`;
        } else if (line.startsWith('>> ')) {
          const sub = line.replace('>> ', '').trim();
          const id = `section-${++subIndex}`;
          navHTML += `<a href="#${id}" class="ml-2">${sub}</a>`;
          html += `<h3 id="${id}" class="text-xl font-semibold mt-8 mb-2">${sub}</h3>`;
        } else if (line.startsWith('# ')) {
          const header = line.replace('# ', '').trim();
          html += `<h1 class="text-3xl font-bold mt-6 mb-2">${header}</h1>`;
        } else if (line.startsWith('<LUA>')) {
          html += '<pre><code>';
        } else if (line.startsWith('</LUA>')) {
          html += '</code></pre>';
        } else if (line.startsWith('<image')) {
          const srcMatch = line.match(/src=['"](.*?)['"]/);
          const altMatch = line.match(/alt=['"](.*?)['"]/);
          const src = srcMatch ? srcMatch[1] : '';
          const alt = altMatch ? altMatch[1] : '';
          html += `<img src="${src}" alt="${alt}" class="rounded shadow-md my-4 max-w-md">`;
        } else {
          html += `<p class="mb-4">${line}</p>`;
        }
      });

      contentContainer.innerHTML = html;
      nav.innerHTML = navHTML;
    }

    parseContent(rawContent);
  </script>
</body>

</html>
