<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Language Docs</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <style>
    pre code {
      display: block;
      padding: 1rem;
      background-color: #1e1e1e;
      color: #d4d4d4;
      font-family: Consolas, monospace;
      border-radius: 0.5rem;
      overflow-x: auto;
    }

    .callout {
      background-color: #bfdbfe;
      border-left: 4px solid #3b82f6;
      color: #1e40af;
      padding: 1rem;
      margin: 1.5rem 0;
    }

    .doc-content h3 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .sidebar a {
      display: block;
      color: #374151;
      padding: 0.25rem 0;
      transition: color 0.2s;
    }

    .sidebar a.active {
      color: #1d4ed8;
      font-weight: bold;
    }
  </style>
</head>

<body class="flex flex-col min-h-screen bg-gray-50">
  <!-- Topbar -->
  <header class="w-full bg-white shadow-md p-4 flex items-center justify-between">
    <h1 class="text-2xl font-bold text-gray-800">My Language Docs</h1>
  </header>

  <!-- Main area with sidebar + content -->
  <div class="flex flex-1">
    <aside class="w-64 bg-white shadow-md p-4 sidebar overflow-y-auto">
      <h2 class="text-lg font-bold mb-4">Documentation</h2>
      <nav id="sidebar-nav" class="space-y-1">
        <!-- Sidebar items will be dynamically populated -->
      </nav>
    </aside>

    <main class="flex-1 p-8 doc-content overflow-y-auto" id="content">
      <!-- Content will be inserted here -->
    </main>
  </div>

  <script>
    const rawContent = `
> 1 Category
>> 1.1  Sub-category
# Header
Brief content text
<LUA>
local a = "b"
</LUA>
<image src='assets/unity.jpeg' alt='unity for sumn reason' />
`;

    function parseContent(raw) {
      const lines = raw.split('\n');
      const contentContainer = document.getElementById('content');
      const nav = document.getElementById('sidebar-nav');
      let html = '';
      let navHTML = '';
      let currentCategory = '';
      let subIndex = 0;

      lines.forEach(line => {
        if (line.startsWith('> ')) {
          currentCategory = line.replace('> ', '').trim();
          navHTML += `<div class='mt-2 font-semibold text-gray-800'>${currentCategory}</div>`;
        } else if (line.startsWith('>> ')) {
          const sub = line.replace('>> ', '').trim();
          const id = `section-${++subIndex}`;
          navHTML += `<a href="#${id}" data-id="${id}" class="ml-4 block text-sm">${sub}</a>`;
          html += `<h3 id="${id}" class="text-xl font-semibold mt-8 mb-2">${sub}</h3>`;
        } else if (line.startsWith('# ')) {
          const header = line.replace('# ', '').trim();
          html += `<h1 class="text-3xl font-bold mt-6 mb-2">${header}</h1>`;
        } else if (line.startsWith('<LUA>')) {
          html += '<pre><code>';
        } else if (line.startsWith('</LUA>')) {
          html += '</code></pre>';
        } else if (line.startsWith('<image')) {
          const srcMatch = line.match(/src=['"](.*?)['"]/);
          const altMatch = line.match(/alt=['"](.*?)['"]/);
          const src = srcMatch ? srcMatch[1] : '';
          const alt = altMatch ? altMatch[1] : '';
          html += `<img src="${src}" alt="${alt}" class="rounded shadow-md my-4 max-w-md">`;
        } else {
          html += `<p class="mb-4">${line}</p>`;
        }
      });

      contentContainer.innerHTML = html;
      nav.innerHTML = navHTML;

      // Highlight active link
      const links = nav.querySelectorAll('a');
      function updateActive() {
        links.forEach(link => {
          const section = document.getElementById(link.dataset.id);
          const rect = section.getBoundingClientRect();
          if (rect.top >= 0 && rect.top < window.innerHeight / 2) {
            links.forEach(l => l.classList.remove('active'));
            link.classList.add('active');
          }
        });
      }

      window.addEventListener('scroll', updateActive);
      updateActive();
    }

    parseContent(rawContent);
  </script>
</body>

</html>
