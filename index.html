<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Language Docs</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }

    pre code {
      display: block;
      padding: 1rem;
      background-color: #1e1e1e;
      color: #d4d4d4;
      font-family: Consolas, monospace;
      border-radius: 0.5rem;
      overflow-x: auto;
    }

    .callout {
      background-color: #1e3a8a;
      border-left: 4px solid #3b82f6;
      color: #93c5fd;
      padding: 1rem;
      margin: 1.5rem 0;
    }

    .sidebar a.active {
      color: #3b82f6;
      font-weight: bold;
    }

    .callout {
      position: fixed;
      bottom: 35px;
      right: 20px;
      margin-left: 20px;
      max-width: 300px;
    }
    
    .callout-header {
      padding: 25px 15px;
      background: #555;
      font-size: 30px;
      color: white;
    }
    
    .callout-container {
      padding: 15px;
      background-color: #ccc;
      color: black
    }
    
    .closebtn {
      position: absolute;
      top: 5px;
      right: 15px;
      color: white;
      font-size: 30px;
      cursor: pointer;
    }
    
    .closebtn:hover {
      color: lightgrey;
    }
  </style>
</head>

<body class="bg-gray-900 text-gray-100 min-h-screen">
  <!-- Topbar -->
  <header class="bg-gray-800 px-6 py-4 shadow-md z-10">
    <h1 class="text-2xl font-bold text-white">My Language Docs</h1>
  </header>

  <!-- Sidebar and content -->
  <div class="flex">
    <!-- Sidebar -->
    <aside class="w-64 bg-gray-800 p-6 h-screen overflow-y-auto border-r border-gray-700 sticky top-0">
      <h2 class="text-lg font-semibold mb-4 text-white">Navigation</h2>
      <nav id="sidebar-nav" class="space-y-1">
        
      </nav>
    </aside>
    
    <main class="flex-1 p-8 doc-content" id="content">
    </main>
  </div>

  <div class="callout">
    <div class="callout-header">Callout Header</div>
    <span class="closebtn" onclick="this.parentElement.style.display='none';">Ã—</span>
    <div class="callout-container">
      <p>Some text to describe the callout message. <a href="#">Learn more</a> or close it if it is in your way.</p>
    </div>
  </div>

  <script>
    const rawContent = `
> 1 Category
>> 1.1 Sub-category
# Header
Brief content text
<LUA>
local a = "b"
</LUA>
<image src='assets/unity.jpeg' alt='bl' />

# 1 Syntax
## 4.5 Literal & Variables
Computers are designed to store and read values quickly and reliably. To take advantage of this, we will need to learn two types of instructions: one for assigning values and one for reading values.

### Literals
A <bold>literal</bold> is a value that is represented directly in source code.  

Different types of values have different rules or <bold>syntax</bold> for how literals must be written.

### Assigning Values

To assign or keep a value in Python, we need a name(also known as identifier) as well as a corresponding value to be assigned.
The equal symbol = is used, the syntax is as follows: 

<LUA>
variable_name = value
</LUA>

There are rules for naming a variable:
1. Can contain uppercase or lowercase letters (A - Z, a - z)
2. Can contain numbers (0 - 9) but cannot start with a number
3. Can contain underscore symbol (_)
4. Cannot contain any other characters (e.g. $ % # or a space)
5. Cannot be of a reserved word that has special meaning in Python
    <b><i>false, nil, local, true, break, while, end, etc</b></i>
            
`;

    function parseContent(raw) {
      const lines = raw.split('\n');
      const contentContainer = document.getElementById('content');
      const nav = document.getElementById('sidebar-nav');
      let html = '';
      let navHTML = '';
      let currentCategory = '';
      let subIndex = 0;
      let lastCatName = "start"

      lines.forEach(line => {
        if (line.startsWith('> ')) {
          currentCategory = line.replace('> ', '').trim();
          navHTML += `<div class='mt-4 text-sm font-bold text-white'>${currentCategory}</div>`;
        } else if (line.startsWith('>> ')) {
          const sub = line.replace('>> ', '').trim();
          const id = `section-${++subIndex}`;
          navHTML += `<a href="#${id}" data-id="${id}" class="ml-4 text-sm text-gray-400 hover:text-white">${sub}</a>`;
          html += `<h3 id="${id}" class="text-xl font-semibold mt-8 mb-2 text-white">${sub}</h3>`;
          lastCatName = sub;
        } else if (line.startsWith('>>> ')) {
          const sub = line.replace('>>> ', '').trim();
          const id = `section-"${lastCatName}"-${++subIndex}`;
          navHTML += `<a href="#${id}" data-id="${id}" class="ml-4 text-sm text-gray-400 hover:text-white">${sub}</a>`;
          html += `<h4 id="${id}" class="text-xl font-semibold mt-8 mb-2 text-white">${sub}</h4>`;
        } else if (line.startsWith('# ')) {
          const header = line.replace('# ', '').trim();
          html += `<h1 class="text-3xl font-bold mt-6 mb-4 text-white">${header}</h1>`;
        } else if (line.startsWith('<LUA>')) {
          html += '<pre><code>';
        } else if (line.startsWith('</LUA>')) {
          html += '</code></pre>';
        } else if (line.startsWith('<image')) {
          const srcMatch = line.match(/src=['"](.*?)['"]/);
          const altMatch = line.match(/alt=['"](.*?)['"]/);
          const src = srcMatch ? srcMatch[1] : '';
          const alt = altMatch ? altMatch[1] : '';
          html += `<img src="${src}" alt="${alt}" class="rounded shadow-md my-4 max-w-md">`;
        } else {
          html += `<p class="mb-4 text-gray-300">${line}</p>`;
        }
      });

      contentContainer.innerHTML = html;
      nav.innerHTML = navHTML;

      const links = nav.querySelectorAll('a');
      function updateActive() {
        let activeFound = false;
        links.forEach(link => {
          const section = document.getElementById(link.dataset.id);
          if (!section) return;
          const rect = section.getBoundingClientRect();
          if (!activeFound && rect.top >= 0 && rect.top < window.innerHeight / 2) {
            links.forEach(l => l.classList.remove('active'));
            link.classList.add('active');
            activeFound = true;
          }
        });
      }

      window.addEventListener('scroll', updateActive);
      updateActive();
    }

    parseContent(rawContent);
  </script>
</body>

</html>
